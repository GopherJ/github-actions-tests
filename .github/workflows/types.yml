on:
    schedule:
        - cron: '*/5 * * * *'
name: Check if types.json has changed
jobs:
    createPullRequest:
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v2
            - name: Pull latest types.json
              run: |
                  curl -fLo resources/types.json https://raw.githubusercontent.com/parallel-finance/parallel/master/resources/types.json
            - name: Check for modified files
              id: git-check
              run: echo ::set-output name=modified::$([ -z "`git status --porcelain`" ] && echo "false" || echo "true")
            - name: Create Pull Request
              if: steps.git-check.outputs.modified == 'true'
              uses: peter-evans/create-pull-request@v3
              with:
                  token: ${{ secrets.GITHUB_TOKEN }}
                  delete-branch: true
                  base: 'testnet'
                  commit-message: update types.json
                  title: 'Update types.json'
                  body: >
                      This PR is auto-generated by
                      [create-pull-request](https://github.com/peter-evans/create-pull-request).
                  labels: |
                      types
                      automated pr
                  assignees: gopherj
                  reviewers: gopherj
            - name: Create Pull Request
              id: cpr
              uses: peter-evans/create-pull-request@v3
            - name: Check outputs
              run: |
                  echo "Pull Request Number - ${{ steps.cpr.outputs.pull-request-number }}"
                  echo "Pull Request URL - ${{ steps.cpr.outputs.pull-request-url }}"
